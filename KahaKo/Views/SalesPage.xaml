<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="KahaKo.Views.SalesPage"
             Title="KahaKo.SalesPage">

    <Grid ColumnDefinitions="2*,*" ColumnSpacing="10">

        <!-- Left: Product Selection -->
        <Grid Grid.Column="0" RowDefinitions="Auto,*" Padding="10">

            <!-- Search Bar -->
            <SearchBar Grid.Row="0" 
                      Placeholder="Search products..."
                      Text="{Binding SearchText}"
                      SearchCommand="{Binding SearchCommand}"/>

            <!-- Product List -->
            <CollectionView Grid.Row="1" 
                           ItemsSource="{Binding Products}"
                           SelectionMode="Single"
                           SelectedItem="{Binding SelectedProduct}">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Grid Padding="10" ColumnDefinitions="*,Auto">
                            <VerticalStackLayout Grid.Column="0">
                                <Label Text="{Binding ProductName}" 
                                       FontSize="16" 
                                       FontAttributes="Bold"/>
                                <Label Text="{Binding Category}" 
                                       FontSize="12" 
                                       TextColor="Gray"/>
                            </VerticalStackLayout>
                            <Label Grid.Column="1" 
                                   Text="{Binding Price, StringFormat='₱{0:N2}'}"
                                   FontSize="16"
                                   VerticalOptions="Center"/>
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </Grid>

        <!-- Right: Cart -->
        <Grid Grid.Column="1" 
              RowDefinitions="Auto,*,Auto,Auto" 
              Padding="10"
              BackgroundColor="#F5F5F5">

            <!-- Cart Header -->
            <Label Grid.Row="0" 
                   Text="Cart" 
                   FontSize="20" 
                   FontAttributes="Bold"
                   Margin="0,0,0,10"/>

            <!-- Cart Items -->
            <CollectionView Grid.Row="1" 
                           ItemsSource="{Binding CartItems}">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Grid Padding="5" ColumnDefinitions="*,Auto,Auto">
                            <Label Grid.Column="0" 
                                   Text="{Binding ProductName}"/>
                            <Label Grid.Column="1" 
                                   Text="{Binding Quantity, StringFormat='x{0}'}"/>
                            <Label Grid.Column="2" 
                                   Text="{Binding Subtotal, StringFormat='₱{0:N2}'}"/>
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <!-- Total -->
            <Border Grid.Row="2" 
                   Padding="10" 
                   Margin="0,10,0,10"
                   BackgroundColor="White">
                <Grid ColumnDefinitions="*,Auto">
                    <Label Grid.Column="0" 
                           Text="TOTAL:" 
                           FontSize="18" 
                           FontAttributes="Bold"/>
                    <Label Grid.Column="1" 
                           Text="{Binding Total, StringFormat='₱{0:N2}'}"
                           FontSize="18" 
                           FontAttributes="Bold"/>
                </Grid>
            </Border>

            <!-- Checkout Button -->
            <Button Grid.Row="3"
                   Text="Checkout"
                   Command="{Binding CheckoutCommand}"
                   BackgroundColor="{StaticResource Primary}"
                   TextColor="White"
                   HeightRequest="50"/>
        </Grid>
    </Grid>
</ContentPage>